## useEffect Hook

> 화면에 보여지는 리액트 컴포넌트에 특정 작업을 할 수 있고, props나 상태가 변경되서 업데이트 될 때도 작업이 가능. 리랜더링 될 때마다 어떤 작업을 등록 가능.

```js
// UserList.js

import React, { useEffect } from 'react';

function User({ user, onRemove, onToggle }) {
  const { username, email, id, active } = user;

  useEffect(() => {
    console.log('컴포넌트가 화면에 나타남');
    // 두번째 parameter는 배열을 넣어주는데, 이 배열을 deps라고 부른다. dependency라는 뜻.
    // 의존되는 값들을 배열안에 넣어주면 된다. 비어있으면 컴포넌트가 처음 화면에 나타날 때만
    // 실행이 된다.
    return () => {
      console.log('컴포넌트가 화면에서 사라짐');
      // 클리너 함수를 뒷정리 함수라고도 부른다.
    };
  }, []);
  return (
    <div>
      <b
        style={{
          color: active ? 'green' : 'black',
          cursor: 'pointer',
        }}
        onClick={() => onToggle(id)}
      >
        {username}
      </b>
      &nbsp;
      <span>({email})</span>
      <button onClick={() => onRemove(id)}>삭제</button>
    </div>
  );
}

function UserList({ users, onRemove, onToggle }) {
  //
  return (
    <div>
      {users.map((user) => (
        <User
          user={user}
          key={user.id}
          onRemove={onRemove}
          onToggle={onToggle}
        />
      ))}
    </div>
  );
}

export default UserList;
```

---

#### 컴포넌트가 마운트 될 때, 주로 추가하는 작업은...

- props로 받은 값을 컴포넌트의 state로 설정
- REST API, 외부 API요청, 특정 API요청할 때,
- D3, Video.js 등의 라이브러리 사용할 때,

- setInterval, setTimeout  등의 작업

> useEffect에서 함수가 호출되는 시점에서는, UI가 화면에 나타난 상태 이후다.
>
> 그래서, DOM에 바로 접근해도 된다.

#### 컴포넌트가 언마운트 될 때, 주로 하는 작업은...

- clearInterval, clearTimeout 등의 작업
- 라이브러리 인스턴스 제거

---



```js
// UserList.js

import React, { useEffect } from 'react';

function User({ user, onRemove, onToggle }) {
  const { username, email, id, active } = user;

  useEffect(() => {
    console.log('user값이 설정됨');
    console.log(user);
    return () => {
      console.log('user값이 바뀌기 전');
      console.log(user);
    };
  }, [user]);
  // useEffect의 함수는, deps값인 [user]가 설정되거나 변경될 때마다 호출이 된다.
  // 처음 화면에 나타날 때에도 호출이 된다는 것을 알고있자.
  // useEffect 함수에서 props로 받아온 값을 참조하거나, useState로 관리하고 있는 값을
  // 참조하고 있는 경우에는 deps배열을 꼭 넣어주어야 한다.
  // 넣지 않으면 오류가 나진 않지만, 경고가 뜬다.

  return (
    <div>
      <b
        style={{
          color: active ? 'green' : 'black',
          cursor: 'pointer',
        }}
        onClick={() => onToggle(id)}
      >
        {username}
      </b>
      &nbsp;
      <span>({email})</span>
      <button onClick={() => onRemove(id)}>삭제</button>
    </div>
  );
}

function UserList({ users, onRemove, onToggle }) {
  //
  return (
    <div>
      {users.map((user) => (
        <User
          user={user}
          key={user.id}
          onRemove={onRemove}
          onToggle={onToggle}
        />
      ))}
    </div>
  );
}

export default UserList;

```

